"use strict";(self.webpackChunkgraduation=self.webpackChunkgraduation||[]).push([[159],{159:(k,p,r)=>{r.r(p),r.d(p,{HomeComponent:()=>K});var u=r(3387),l=r(6814),d=r(7680),c=r(95),m=r(8525),g=r(4170),f=r(2032),h=r(4716),t=r(5879),C=r(6989),P=r(4186),x=r(5501),O=r(2848),v=r(2401),M=r(3680);function b(n,a){if(1&n&&(t.TgZ(0,"mat-option",13),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function T(n,a){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," patient selction is "),t.TgZ(2,"strong"),t._uU(3,"required"),t.qZA()())}function D(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"ngx-dropzone-preview",14),t.NdJ("removed",function(){const s=t.CHM(e).$implicit,_=t.oxw();return t.KtG(_.onRemove(s))}),t.TgZ(1,"ngx-dropzone-label"),t._uU(2),t.qZA()()}if(2&n){const e=a.$implicit;t.Q6J("removable",!0),t.xp6(2),t.AsE("",e.name," (",e.type,")")}}function Z(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1,"Analyze Now"),t.qZA())}function I(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1,"Analyzing image "),t._UZ(2,"i",15),t.qZA())}function A(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1,"save scan"),t.qZA())}function U(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1,"saving"),t.qZA())}function w(n,a){1&n&&t._UZ(0,"i",24)}function E(n,a){1&n&&t._UZ(0,"i",25)}const F=function(n){return{width:n}};function y(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"h2",18),t._uU(2,"Based on image attached the result is "),t.TgZ(3,"span"),t._uU(4),t.qZA()(),t.TgZ(5,"button",19),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.saveScan())}),t.YNc(6,A,2,0,"span",7),t.YNc(7,U,2,0,"span",7),t.YNc(8,w,1,0,"i",20),t.YNc(9,E,1,0,"i",21),t.qZA(),t.TgZ(10,"div",22)(11,"div",23),t._uU(12),t.qZA()()()}if(2&n){const e=t.oxw(2);t.xp6(4),t.Oqu(e.prediction),t.xp6(2),t.Q6J("ngIf",!e.uploaded),t.xp6(1),t.Q6J("ngIf",e.uploaded),t.xp6(1),t.Q6J("ngIf",!e.uploaded),t.xp6(1),t.Q6J("ngIf",e.uploaded),t.xp6(2),t.Q6J("ngStyle",t.VKq(8,F,e.percentage+"%")),t.uIk("aria-valuenow",e.percentage),t.xp6(1),t.hij(" ",e.percentage,"% ")}}function H(n,a){1&n&&t._UZ(0,"i",32)}function J(n,a){1&n&&t._UZ(0,"i",15)}function N(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.showDetails())}),t._uU(1,"Show Details "),t.YNc(2,H,1,0,"i",30),t.YNc(3,J,1,0,"i",31),t.qZA()}if(2&n){const e=t.oxw(3);t.xp6(2),t.Q6J("ngIf",!e.isLoading),t.xp6(1),t.Q6J("ngIf",e.isLoading)}}function S(n,a){1&n&&t._UZ(0,"i",32)}function z(n,a){1&n&&t._UZ(0,"i",15)}function Y(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.showDetails())}),t._uU(1,"Hide Details "),t.YNc(2,S,1,0,"i",30),t.YNc(3,z,1,0,"i",31),t.qZA()}if(2&n){const e=t.oxw(3);t.xp6(2),t.Q6J("ngIf",!e.isLoading),t.xp6(1),t.Q6J("ngIf",e.isLoading)}}function Q(n,a){if(1&n&&(t.TgZ(0,"div",26),t._UZ(1,"img",27),t.TgZ(2,"p"),t._uU(3,"All data were saved in the patient's history"),t.qZA(),t.YNc(4,N,4,2,"button",28),t.YNc(5,Y,4,2,"button",28),t.qZA()),2&n){const e=t.oxw(2);t.xp6(4),t.Q6J("ngIf",!e.detailsClicked),t.xp6(1),t.Q6J("ngIf",e.detailsClicked)}}function L(n,a){if(1&n&&(t.TgZ(0,"div",16),t.YNc(1,y,13,10,"div",7),t.YNc(2,Q,6,2,"div",17),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!e.saved),t.xp6(1),t.Q6J("ngIf",e.saved)}}function B(n,a){if(1&n&&(t.TgZ(0,"div",33)(1,"div",34)(2,"div",35)(3,"div",36)(4,"mat-form-field",37)(5,"mat-label"),t._uU(6,"Disease Name"),t.qZA(),t._UZ(7,"input",38),t.qZA(),t.TgZ(8,"mat-form-field",4)(9,"mat-label"),t._uU(10,"Discription"),t.qZA(),t._UZ(11,"textarea",39),t.qZA(),t.TgZ(12,"mat-form-field",37)(13,"mat-label"),t._uU(14,"Symptomps"),t.qZA(),t._UZ(15,"input",38),t.qZA(),t.TgZ(16,"mat-form-field",37)(17,"mat-label"),t._uU(18,"Treatments"),t.qZA(),t._UZ(19,"input",38),t.qZA()()(),t.TgZ(20,"div",40)(21,"div",41),t._UZ(22,"img",42),t.qZA()()()()),2&n){const e=t.oxw();t.xp6(7),t.Q6J("value",e.diseaseName),t.xp6(4),t.Q6J("value",e.description),t.xp6(4),t.Q6J("value",e.symptoms),t.xp6(4),t.Q6J("value",e.treatment),t.xp6(3),t.Q6J("src",e.skinDiseasePhotoUrl,t.LSH)}}const q=function(){return[]};let K=(()=>{class n{constructor(e,o,i,s,_,R){this._DatePipe=e,this._RecordsService=o,this._AngularFireStorage=i,this._DiseaseService=s,this._DataService=_,this._GeminiService=R,this.loadingFlag=!1,this.files=[],this.percentage=0,this.formattedTimestamp="",this.patients=[],this.skinDiseasePhotoUrl="",this.diseaseName="",this.description="",this.symptoms=[],this.treatment="",this.isLoading=!1,this.detailsClicked=!1,this.saved=!1,this.uploaded=!1,this.sendImageForm=new c.cw({fileup:new c.NI(null,[c.kI.required]),id:new c.NI(null,[c.kI.required])})}ngOnInit(){this.getPatients()}onSelect(e){console.log(e),this.selectedFiles=e.addedFiles,console.log(this.selectedFiles),this.files.push(e.addedFiles[0]),this.sendImageForm.get("fileup")?.setValue(this.files)}onRemove(e){console.log(e),this.files.splice(this.files.indexOf(e),1)}getPatients(){this._DataService.getAllPatients().subscribe({next:e=>{this.patients=e.map(o=>{const i=o.payload.doc.data();return i.id=o.payload.doc.id,i}),console.log(this.patients)},error:e=>{console.log(e)}})}saveScan(){this.uploaded=!0,this.currentSelectedFile=new u.O(this.selectedFiles[0]);const o=this._AngularFireStorage.ref("Uploads/"+this.currentSelectedFile.file.name);o.put(this.selectedFiles[0]).snapshotChanges().pipe((0,h.x)(()=>{o.getDownloadURL().subscribe(s=>{this.currentSelectedFile.image=s,this.currentSelectedFile.name=this.currentSelectedFile.file.name,this.currentSelectedFile.size=this.currentSelectedFile.file.size,this.currentSelectedFile.prediction=this.prediction,this.currentSelectedFile.treatment=this.treatment,this._RecordsService.saveFileMetaData(this.currentSelectedFile,this.sendImageForm.get("id")?.value)})})).subscribe({next:s=>{console.log(s),this.percentage=100*s.bytesTransferred/s.totalBytes,100==this.percentage&&setTimeout(()=>{this.saved=!0,this.uploaded=!1},1e3)},error:s=>{console.log(s)}})}getDetails(e){this._DataService.getTreatments(e).subscribe({next:o=>{this.allDetails=o.payload.data(),console.log(this.allDetails)},error:o=>{console.log(o)}})}sendImage(){console.log(this.sendImageForm.get("id")?.value),this.loadingFlag=!0;let e=new FormData;e.append("fileup",this.selectedFiles[0]),this._DiseaseService.diseaseApi(e).subscribe({next:o=>{console.log(o),this.prediction=o.prediction,this._DataService.diseaseName.next(this.prediction),this.fetchDiseaseData(this.prediction),this.getDetails(this.prediction),console.log(this.prediction),this.loadingFlag=!1,this._DataService.updateDiseaseProperty().doc(this.sendImageForm.get("id")?.value).update({disease:this.prediction}).then(()=>{console.log("Property updated successfully")}).catch(i=>{console.error("Error updating property: ",i)})},error:o=>{console.log(o),this.loadingFlag=!1,this.prediction="Diagnoses Not Avaliable"}})}showDetails(){this.fetchDiseaseData(this.prediction),this.detailsClicked=!this.detailsClicked,this.isLoading=!this.isLoading}fetchDiseaseData(e){this._DiseaseService.getDiseaseData(e).subscribe(o=>{o?(console.log(o),this.skinDiseasePhotoUrl=o.image_url,this.diseaseName=o.disease_name,this.description=o.description,this.symptoms=o.symptoms.split(",").map(i=>i.trim()),this.treatment=o.treatment,this.isLoading=!1):this.isLoading=!1})}static#t=this.\u0275fac=function(o){return new(o||n)(t.Y36(l.uU),t.Y36(C.$),t.Y36(P.Q1),t.Y36(x.j),t.Y36(O.D),t.Y36(v.e))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-home"]],standalone:!0,features:[t._Bn([l.uU]),t.jDz],decls:22,vars:10,consts:[[1,"main","container"],[1,"shadow","p-3"],[1,"w-75","content","mx-auto"],["action","",3,"formGroup","ngSubmit"],[1,"w-100"],["formControlName","id"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"w-100","m-auto",3,"change"],[3,"removable","removed",4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-outline-primary","mt-2","d-block","mx-auto",3,"disabled"],["class","shadow rounded-2 my-3 p-3  prediction",4,"ngIf"],["class","container shadow  rounded-2 mt-5 mb-3 details",4,"ngIf"],[3,"value"],[3,"removable","removed"],[1,"fa","fa-spinner","fa-spin"],[1,"shadow","rounded-2","my-3","p-3","prediction"],["class","d-flex justify-content-center align-items-center flex-column prediction",4,"ngIf"],[1,"m-0","text-center"],["type","button",1,"btn","btn-success","d-block","m-auto","my-3",3,"click"],["class","fa-solid fa-cloud-arrow-up ms-2",4,"ngIf"],["class","fa fa-spinner fa-spin ms-2",4,"ngIf"],[1,"progress"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-info",3,"ngStyle"],[1,"fa-solid","fa-cloud-arrow-up","ms-2"],[1,"fa","fa-spinner","fa-spin","ms-2"],[1,"d-flex","justify-content-center","align-items-center","flex-column","prediction"],["src","assets/images/validation.png","alt",""],["type","button","class","treatment",3,"click",4,"ngIf"],["type","button",1,"treatment",3,"click"],["class","fa-solid fa-briefcase-medical",4,"ngIf"],["class","fa fa-spinner fa-spin",4,"ngIf"],[1,"fa-solid","fa-briefcase-medical"],[1,"container","shadow","rounded-2","mt-5","mb-3","details"],[1,"row","justify-content-center","bg-light"],[1,"col-md-6","details-content"],[1,"p-4"],["appearance","outline",1,"w-100"],["disabled","","type","text","matInput","","placeholder","Disease",3,"value"],["disabled","","matInput","","placeholder","Discription",3,"value"],[1,"col-md-6","bg-white","details-image"],[1,"py-3"],["alt","skin disease",1,"w-100","rounded-3",3,"src"]],template:function(o,i){if(1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3),t.NdJ("ngSubmit",function(){return i.sendImage()}),t.TgZ(4,"div")(5,"mat-form-field",4)(6,"mat-label"),t._uU(7,"Select Patient"),t.qZA(),t.TgZ(8,"mat-select",5),t.YNc(9,b,2,2,"mat-option",6),t.qZA(),t.YNc(10,T,4,0,"mat-error",7),t.qZA()(),t.TgZ(11,"div")(12,"ngx-dropzone",8),t.NdJ("change",function(_){return i.onSelect(_)}),t.TgZ(13,"ngx-dropzone-label"),t._uU(14,"Drop your image here"),t.qZA(),t.YNc(15,D,3,3,"ngx-dropzone-preview",9),t.qZA()(),t.TgZ(16,"div")(17,"button",10),t.YNc(18,Z,2,0,"span",7),t.YNc(19,I,3,0,"span",7),t.qZA(),t.YNc(20,L,3,2,"div",11),t.YNc(21,B,23,5,"div",12),t.qZA()()()()()),2&o){let s;t.xp6(3),t.Q6J("formGroup",i.sendImageForm),t.xp6(6),t.Q6J("ngForOf",i.patients),t.xp6(1),t.Q6J("ngIf",null==(s=i.sendImageForm.get("id"))||null==s.errors?null:s.errors.required),t.xp6(5),t.Q6J("ngForOf",i.files),t.xp6(2),t.Q6J("disabled",i.sendImageForm.invalid&&i.files!=t.DdM(9,q)),t.xp6(1),t.Q6J("ngIf",!i.loadingFlag),t.xp6(1),t.Q6J("ngIf",i.loadingFlag),t.xp6(1),t.Q6J("ngIf",i.prediction),t.xp6(1),t.Q6J("ngIf",i.detailsClicked)}},dependencies:[l.ez,l.sg,l.O5,l.PC,d.bB,d._f,d.NP,d.dt,c.UX,c._Y,c.JJ,c.JL,c.sg,c.u,m.LD,g.KE,g.hX,g.TO,m.gD,M.ey,g.lN,f.c,f.Nt,c.u5],styles:[".response-container[_ngcontent-%COMP%]{border:1px solid #ccc;padding:20px;width:80%!important;margin-left:auto;margin-top:20px;box-shadow:0 0 10px #0000001a;border-radius:8px;background-color:#f9f9f9;font-family:Arial,sans-serif}.prompts[_ngcontent-%COMP%]{width:max-content;max-width:80%!important}.response-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:22px;margin-bottom:10px;color:#333}.response-container[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding-left:20px;margin-bottom:20px;list-style-type:disc}.response-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:10px;line-height:1.6}.response-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:15px;line-height:1.6;color:#555}.response-container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:700;color:#000}.left[_ngcontent-%COMP%]{position:absolute;top:90%;transform:translateY(-50%);right:0;display:flex;cursor:move;z-index:999}.left[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{cursor:pointer}.right[_ngcontent-%COMP%]{width:400px;position:absolute;top:50%;right:0;z-index:999;transform:translateY(-50%)}.right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardHeader[_ngcontent-%COMP%]{cursor:move;text-align:center}.right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardHeader[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{padding-block:10px;font-size:1.2rem;font-weight:500;text-transform:capitalize;margin:0}.right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardHeader[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{right:15px;font-size:30px;top:50%;transform:translateY(-50%);color:#555;cursor:pointer}.right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardBody[_ngcontent-%COMP%]{height:350px;max-width:400px;overflow:auto}.right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardFooter[_ngcontent-%COMP%]{padding:10px}.chat-ai[_ngcontent-%COMP%]{min-width:400px;z-index:9;top:50%;right:0;transform:translateY(-50%)}.chat-ai[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardHeader[_ngcontent-%COMP%]{text-align:center}.chat-ai[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardHeader[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{padding-block:10px;font-size:1.2rem;font-weight:500;text-transform:capitalize;margin:0}.chat-ai[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardHeader[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{right:15px;font-size:30px;top:50%;transform:translateY(-50%);color:#555;cursor:pointer}.chat-ai[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardBody[_ngcontent-%COMP%]{height:350px;max-width:400px;overflow:auto}.chat-ai[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardFooter[_ngcontent-%COMP%]{padding:10px}.details[_ngcontent-%COMP%]   .treatment[_ngcontent-%COMP%]{border:none;padding:10px;background-color:var(--main-color);border-radius:10px;margin-top:10px;font-weight:500;transition:all .2s linear}.details[_ngcontent-%COMP%]   .treatment[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:10px;transition:all .3s linear}.details[_ngcontent-%COMP%]   .treatment[_ngcontent-%COMP%]:hover{background-color:#00a666;color:#fff}.details[_ngcontent-%COMP%]   .treatment[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:var(--bs-white)!important;transform:scale(1.2)}.prediction[_ngcontent-%COMP%]{background-color:var(--second-color);font-size:16px;color:#fff}.prediction[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px}.prediction[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;color:#ffffff80}.prediction[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.4em}.prediction[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--tomato);font-weight:1000}.prediction[_ngcontent-%COMP%]   .treatment[_ngcontent-%COMP%]{border:none;padding:10px;background-color:var(--main-color);border-radius:10px;margin-top:10px;font-weight:500;transition:all .2s linear}.prediction[_ngcontent-%COMP%]   .treatment[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:10px;transition:all .3s linear}.prediction[_ngcontent-%COMP%]   .treatment[_ngcontent-%COMP%]:hover{background-color:#00a666;color:#fff}.prediction[_ngcontent-%COMP%]   .treatment[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:var(--bs-white)!important;transform:scale(1.2)}mat-form-field[_ngcontent-%COMP%]{border-color:red!important}mat-form-field[_ngcontent-%COMP%]   mat-label[_ngcontent-%COMP%]{color:var(--main-color)!important}mat-form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled{color:#000!important}mat-form-field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:none}mat-form-field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:disabled{color:#000!important}@media screen and (max-width: 768px){.prediction[_ngcontent-%COMP%]{font-size:12px}.right[_ngcontent-%COMP%]{width:360px!important}.chat-ai[_ngcontent-%COMP%]{min-width:380px!important;z-index:99}.chat-ai[_ngcontent-%COMP%]   #cardBody[_ngcontent-%COMP%]{max-width:380px!important}.main[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{width:100%!important}.details-image[_ngcontent-%COMP%]{order:0}.details-content[_ngcontent-%COMP%]{order:1}}"]})}return n})()}}]);