"use strict";(self.webpackChunkgraduation=self.webpackChunkgraduation||[]).push([[994],{5994:(Q,m,a)=>{a.r(m),a.d(m,{HomeComponent:()=>U});var u=a(3387),d=a(6814),g=a(7680),s=a(95),h=a(8525),p=a(6210),_=a(2032),x=a(4716),e=a(5879),C=a(6989),v=a(4186),M=a(5501),O=a(2848),f=a(9862);let T=(()=>{class n{constructor(t){this.http=t,this.apiUrl="https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent",this.apiKey="AIzaSyC_L958W5m-lKzjmHsBiUsg8vg0UuW78Ic"}generateContent(t){const i=(new f.WM).set("Content-Type","application/json").set("x-goog-api-key",this.apiKey);return this.http.post(this.apiUrl,{contents:[{role:"user",parts:[{text:t}]}]},{headers:i})}static#e=this.\u0275fac=function(i){return new(i||n)(e.LFG(f.eN))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var y=a(3680);function P(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"span",18),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.toggleChat())}),e._uU(1,"Need help? "),e._UZ(2,"i",19),e.qZA()}}function b(n,l){if(1&n&&e._UZ(0,"div",33),2&n){const t=e.oxw(2);e.Q6J("innerHtml",t.generatedText,e.oJD)}}function Z(n,l){1&n&&e._UZ(0,"i",34)}function F(n,l){1&n&&e._UZ(0,"i",35)}function w(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"div",20)(1,"div",21)(2,"div",22)(3,"h3",23),e._uU(4,"Chat with Gemini Ai"),e.qZA(),e.TgZ(5,"i",24),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.toggleChat())}),e.qZA()(),e.TgZ(6,"div",25),e.YNc(7,b,1,1,"div",26),e.qZA(),e.TgZ(8,"div",27)(9,"div",28)(10,"input",29),e.NdJ("ngModelChange",function(o){e.CHM(t);const c=e.oxw();return e.KtG(c.prompt=o)}),e.qZA(),e.TgZ(11,"button",30),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.generateContent())}),e.YNc(12,Z,1,0,"i",31),e.YNc(13,F,1,0,"i",32),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(7),e.Q6J("ngIf",t.generatedText),e.xp6(3),e.Q6J("ngModel",t.prompt),e.xp6(2),e.Q6J("ngIf",!t.loading),e.xp6(1),e.Q6J("ngIf",t.loading)}}function I(n,l){if(1&n&&(e.TgZ(0,"mat-option",36),e._uU(1),e.qZA()),2&n){const t=l.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function H(n,l){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," patient selction is "),e.TgZ(2,"strong"),e._uU(3,"required"),e.qZA()())}function A(n,l){if(1&n){const t=e.EpF();e.TgZ(0,"ngx-dropzone-preview",37),e.NdJ("removed",function(){const c=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.onRemove(c))}),e.TgZ(1,"ngx-dropzone-label"),e._uU(2),e.qZA()()}if(2&n){const t=l.$implicit;e.Q6J("removable",!0),e.xp6(2),e.AsE("",t.name," (",t.type,")")}}function S(n,l){1&n&&(e.TgZ(0,"span"),e._uU(1,"Analyze Now"),e.qZA())}function J(n,l){1&n&&(e.TgZ(0,"span"),e._uU(1,"Analyzing image "),e._UZ(2,"i",35),e.qZA())}function N(n,l){if(1&n&&(e.TgZ(0,"h2",38),e._uU(1,"Patient possible disease name is : "),e.TgZ(2,"span",39),e._uU(3),e.qZA()()),2&n){const t=e.oxw();e.xp6(3),e.Oqu(t.prediction)}}const z=function(n){return{width:n}};let U=(()=>{class n{constructor(t,i,o,c,r){this._RecordsService=t,this._AngularFireStorage=i,this._DiseaseService=o,this._DataService=c,this._GeminiService=r,this.loadingFlag=!1,this.files=[],this.percentage=0,this.patients=[],this.prompt="",this.loading=!1,this.allGeneratedText=[],this.generatedText="",this.chat=!1,this.sendImageForm=new s.cw({fileup:new s.NI(null,[s.kI.required]),id:new s.NI(null,[s.kI.required])})}ngOnInit(){this.getPatients()}onSelect(t){console.log(t),this.selectedFiles=t.addedFiles,console.log(this.selectedFiles),this.files.push(t.addedFiles[0]),this.sendImageForm.get("fileup")?.setValue(this.files)}onRemove(t){console.log(t),this.files.splice(this.files.indexOf(t),1)}getPatients(){this._DataService.getAllPatients().subscribe({next:t=>{this.patients=t.map(i=>{const o=i.payload.doc.data();return o.id=i.payload.doc.id,o}),console.log(this.patients)},error:t=>{console.log(t)}})}sendImage(){console.log(this.sendImageForm.get("id")?.value),this.loadingFlag=!0;let t=new FormData;t.append("fileup",this.selectedFiles[0]),this.currentSelectedFile=new u.O(this.selectedFiles[0]);const o=this._AngularFireStorage.ref("Uploads/"+this.currentSelectedFile.file.name);o.put(this.selectedFiles[0]).snapshotChanges().pipe((0,x.x)(()=>{o.getDownloadURL().subscribe(r=>{this.currentSelectedFile.url=r,this.currentSelectedFile.name=this.currentSelectedFile.file.name,this.currentSelectedFile.size=this.currentSelectedFile.file.size,this.currentSelectedFile.prediction=this.prediction,this._RecordsService.saveFileMetaData(this.currentSelectedFile,this.sendImageForm.get("id")?.value)})})).subscribe({next:r=>{console.log(r),this.percentage=100*r.bytesTransferred/r.totalBytes},error:r=>{console.log(r)}}),this._DiseaseService.diseaseApi(t).subscribe({next:r=>{console.log(r),this.prediction=r.prediction,this._DataService.diseaseName.next(this.prediction),console.log(this.prediction),this.loadingFlag=!1,this._DataService.updateDiseaseProperty().doc(this.sendImageForm.get("id")?.value).update({disease:this.prediction}).then(()=>{console.log("Property updated successfully")}).catch(Y=>{console.error("Error updating property: ",Y)})},error:r=>{console.log(r),this.loadingFlag=!1,this.prediction="Diagnoses Not Avaliable"}})}generateContent(){this.loading=!0,this._GeminiService.generateContent(this.prompt).subscribe({next:t=>{this.loading=!1,this.generatedText=this.styleContent(t.candidates[0].content.parts[0].text),this.allGeneratedText.push(this.generatedText),console.log(this.allGeneratedText),this.prompt=""},error:t=>{this.loading=!1,console.error("Error generating content:",t)}})}styleContent(t){return(t=(t=(t=(t=(t=(t=(t=t.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")).replace(/(?:^|\n)\*\s/g,"<li>").replace(/\n\s*\*\s/g,"</li><li>")).replace(/(<li>.*<\/li>)/gs,"<ul>$1</ul>")).replace(/<\/li>\n/g,"</li>")).replace(/(?:^|\n)(\*\*.*?\*\*)/g,"<h2>$1</h2>")).replace(/\n/g,"<p>")).replace(/<p><\/li>/g,"</li>")).replace(/<\/ul><p>/g,"</ul>")}toggleChat(){this.chat=!this.chat}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(C.$),e.Y36(v.Q1),e.Y36(M.j),e.Y36(O.D),e.Y36(T))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-home"]],standalone:!0,features:[e.jDz],decls:29,vars:15,consts:[[1,"main","container","my-3"],[1,"chat-ai","position-fixed"],[1,"left"],["class","bg-info p-2 rounded-5 fs-6 textwh text-primary-emphasis",3,"click",4,"ngIf"],["class","right",4,"ngIf"],[1,"shadow","p-3"],[1,"w-75","mx-auto"],["action","",3,"formGroup","ngSubmit"],[1,"w-100"],["formControlName","id"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"w-100","m-auto",3,"change"],[3,"removable","removed",4,"ngFor","ngForOf"],[1,"progress","mt-3"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-info",3,"ngStyle"],["type","submit",1,"btn","btn-outline-primary","mt-2","d-block","mx-auto",3,"disabled"],["class","text-center",4,"ngIf"],[1,"bg-info","p-2","rounded-5","fs-6","textwh","text-primary-emphasis",3,"click"],[1,"fa","fa-comment-medical"],[1,"right"],["id","card",1,"rounded-2"],["id","cardHeader",1,"rounded-top-2","bg-body-tertiary","position-relative"],[1,"text-secondary"],[1,"fa-solid","fa-circle-xmark","position-absolute",3,"click"],["id","cardBody",1,"bg-body-secondary"],["class","response-container",3,"innerHtml",4,"ngIf"],["id","cardFooter",1,"bg-body-tertiary","rounded-bottom-2"],[1,"gap-3","d-flex","justify-content-between","align-items-center"],["type","text","id","gemini","placeholder","what do you think?",1,"form-control",3,"ngModel","ngModelChange"],["title","talk","type","button",1,"btn","btn-outline-secondary",3,"click"],["class","fa-solid fa-comment-dots",4,"ngIf"],["class","fa fa-spinner fa-spin",4,"ngIf"],[1,"response-container",3,"innerHtml"],[1,"fa-solid","fa-comment-dots"],[1,"fa","fa-spinner","fa-spin"],[3,"value"],[3,"removable","removed"],[1,"text-center"],[1,"text-primary"]],template:function(i,o){if(1&i&&(e.TgZ(0,"div",0)(1,"div")(2,"div",1)(3,"div",2),e.YNc(4,P,3,0,"span",3),e.qZA(),e.YNc(5,w,14,4,"div",4),e.qZA()(),e.TgZ(6,"div",5)(7,"div",6)(8,"form",7),e.NdJ("ngSubmit",function(){return o.sendImage()}),e.TgZ(9,"div")(10,"mat-form-field",8)(11,"mat-label"),e._uU(12,"Select Patient"),e.qZA(),e.TgZ(13,"mat-select",9),e.YNc(14,I,2,2,"mat-option",10),e.qZA(),e.YNc(15,H,4,0,"mat-error",11),e.qZA()(),e.TgZ(16,"div")(17,"ngx-dropzone",12),e.NdJ("change",function(r){return o.onSelect(r)}),e.TgZ(18,"ngx-dropzone-label"),e._uU(19,"Drop your image here"),e.qZA(),e.YNc(20,A,3,3,"ngx-dropzone-preview",13),e.qZA(),e.TgZ(21,"div",14)(22,"div",15),e._uU(23),e.qZA()()(),e.TgZ(24,"div")(25,"button",16),e.YNc(26,S,2,0,"span",11),e.YNc(27,J,3,0,"span",11),e.qZA(),e.YNc(28,N,4,1,"h2",17),e.qZA()()()()()),2&i){let c;e.xp6(4),e.Q6J("ngIf",!o.chat),e.xp6(1),e.Q6J("ngIf",o.chat),e.xp6(3),e.Q6J("formGroup",o.sendImageForm),e.xp6(6),e.Q6J("ngForOf",o.patients),e.xp6(1),e.Q6J("ngIf",null==(c=o.sendImageForm.get("id"))||null==c.errors?null:c.errors.required),e.xp6(5),e.Q6J("ngForOf",o.files),e.xp6(2),e.Q6J("ngStyle",e.VKq(13,z,o.percentage+"%")),e.uIk("aria-valuenow",o.percentage),e.xp6(1),e.hij(" ",o.percentage,"% "),e.xp6(2),e.Q6J("disabled",o.sendImageForm.invalid),e.xp6(1),e.Q6J("ngIf",!o.loadingFlag),e.xp6(1),e.Q6J("ngIf",o.loadingFlag),e.xp6(1),e.Q6J("ngIf",o.prediction)}},dependencies:[d.ez,d.sg,d.O5,d.PC,g.bB,g._f,g.NP,g.dt,s.UX,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,h.LD,p.KE,p.hX,p.TO,h.gD,y.ey,p.lN,_.c,s.u5,s.On],styles:[".response-container[_ngcontent-%COMP%]{border:1px solid #ccc;padding:20px;width:100%;min-width:400px;max-width:600px;box-shadow:0 0 10px #0000001a;border-radius:8px;font-family:Arial,sans-serif}.response-container[_ngcontent-%COMP%]{border:1px solid #ccc;padding:20px;width:100%;box-shadow:0 0 10px #0000001a;border-radius:8px;background-color:#f9f9f9}.response-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:22px;margin-bottom:10px;color:#333}.response-container[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding-left:20px;margin-bottom:20px;list-style-type:disc}.response-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:10px;line-height:1.6}.response-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:15px;line-height:1.6;color:#555}.response-container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:700;color:#000}.chat-ai[_ngcontent-%COMP%]{min-width:400px;z-index:9;top:50%;right:0;transform:translateY(-50%)}.chat-ai[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{position:absolute;top:15px;right:0}.chat-ai[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{cursor:pointer}.chat-ai[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardHeader[_ngcontent-%COMP%]{text-align:center}.chat-ai[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardHeader[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{padding-block:10px;font-size:1.2rem;font-weight:500;text-transform:capitalize;margin:0}.chat-ai[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardHeader[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{right:15px;font-size:30px;top:50%;transform:translateY(-50%);color:#555;cursor:pointer}.chat-ai[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardBody[_ngcontent-%COMP%]{height:350px;max-width:400px;overflow:auto}.chat-ai[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardFooter[_ngcontent-%COMP%]{padding:10px}@media screen and (max-width: 768px){.chat-ai[_ngcontent-%COMP%]{min-width:380px!important;z-index:99}.chat-ai[_ngcontent-%COMP%]   #cardBody[_ngcontent-%COMP%]{max-width:380px!important}}"]})}return n})()}}]);