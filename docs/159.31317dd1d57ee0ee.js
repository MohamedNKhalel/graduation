"use strict";(self.webpackChunkgraduation=self.webpackChunkgraduation||[]).push([[159],{159:(S,m,r)=>{r.r(m),r.d(m,{HomeComponent:()=>y});var u=r(3387),l=r(6814),_=r(7680),a=r(95),h=r(8525),d=r(4170),f=r(2032),O=r(4716),e=r(5879),P=r(6989),C=r(4186),M=r(5501),x=r(2848),v=r(2401),D=r(3680);function E(o,g){if(1&o&&(e.TgZ(0,"mat-option",14),e._uU(1),e.qZA()),2&o){const t=g.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function F(o,g){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," patient selction is "),e.TgZ(2,"strong"),e._uU(3,"required"),e.qZA()())}function T(o,g){if(1&o){const t=e.EpF();e.TgZ(0,"ngx-dropzone-preview",15),e.NdJ("removed",function(){const c=e.CHM(t).$implicit,i=e.oxw();return e.KtG(i.onRemove(c))}),e.TgZ(1,"ngx-dropzone-label"),e._uU(2),e.qZA()()}if(2&o){const t=g.$implicit;e.Q6J("removable",!0),e.xp6(2),e.AsE("",t.name," (",t.type,")")}}function A(o,g){1&o&&(e.TgZ(0,"span"),e._uU(1,"Analyze Now"),e.qZA())}function I(o,g){1&o&&(e.TgZ(0,"span"),e._uU(1,"Analyzing image "),e._UZ(2,"i",16),e.qZA())}function U(o,g){if(1&o&&(e.TgZ(0,"h2",17),e._uU(1,"Patient possible disease name is : "),e.TgZ(2,"span",18),e._uU(3),e.qZA()()),2&o){const t=e.oxw();e.xp6(3),e.Oqu(t.prediction)}}const Z=function(o){return{width:o}},b=function(){return[]};let y=(()=>{class o{constructor(t,s,n,c,i,p){this._DatePipe=t,this._RecordsService=s,this._AngularFireStorage=n,this._DiseaseService=c,this._DataService=i,this._GeminiService=p,this.loadingFlag=!1,this.files=[],this.percentage=0,this.formattedTimestamp="",this.patients=[],this.sendImageForm=new a.cw({fileup:new a.NI(null,[a.kI.required]),id:new a.NI(null,[a.kI.required])})}ngOnInit(){this.getPatients()}onSelect(t){console.log(t),this.selectedFiles=t.addedFiles,console.log(this.selectedFiles),this.files.push(t.addedFiles[0]),this.sendImageForm.get("fileup")?.setValue(this.files)}onRemove(t){console.log(t),this.files.splice(this.files.indexOf(t),1)}getPatients(){this._DataService.getAllPatients().subscribe({next:t=>{this.patients=t.map(s=>{const n=s.payload.doc.data();return n.id=s.payload.doc.id,n}),console.log(this.patients)},error:t=>{console.log(t)}})}sendImage(){console.log(this.sendImageForm.get("id")?.value),this.loadingFlag=!0;let t=new FormData;t.append("fileup",this.selectedFiles[0]),this.currentSelectedFile=new u.O(this.selectedFiles[0]);const n=this._AngularFireStorage.ref("Uploads/"+this.currentSelectedFile.file.name);n.put(this.selectedFiles[0]).snapshotChanges().pipe((0,O.x)(()=>{n.getDownloadURL().subscribe(i=>{this.currentSelectedFile.image=i,this.currentSelectedFile.name=this.currentSelectedFile.file.name,this.currentSelectedFile.size=this.currentSelectedFile.file.size,this.currentSelectedFile.prediction=this.prediction,this._RecordsService.saveFileMetaData(this.currentSelectedFile,this.sendImageForm.get("id")?.value)})})).subscribe({next:i=>{console.log(i),this.percentage=100*i.bytesTransferred/i.totalBytes},error:i=>{console.log(i)}}),this._DiseaseService.diseaseApi(t).subscribe({next:i=>{console.log(i),this.prediction=i.prediction,this._DataService.diseaseName.next(this.prediction),console.log(this.prediction),this.loadingFlag=!1,this._DataService.updateDiseaseProperty().doc(this.sendImageForm.get("id")?.value).update({disease:this.prediction}).then(()=>{console.log("Property updated successfully")}).catch(p=>{console.error("Error updating property: ",p)})},error:i=>{console.log(i),this.loadingFlag=!1,this.prediction="Diagnoses Not Avaliable"}})}static#e=this.\u0275fac=function(s){return new(s||o)(e.Y36(l.uU),e.Y36(P.$),e.Y36(C.Q1),e.Y36(M.j),e.Y36(x.D),e.Y36(v.e))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-home"]],standalone:!0,features:[e._Bn([l.uU]),e.jDz],decls:24,vars:14,consts:[[1,"main","container"],[1,"shadow","p-3"],[1,"w-75","mx-auto"],["action","",3,"formGroup","ngSubmit"],[1,"w-100"],["formControlName","id"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"w-100","m-auto",3,"change"],[3,"removable","removed",4,"ngFor","ngForOf"],[1,"progress","mt-3"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-info",3,"ngStyle"],["type","submit",1,"btn","btn-outline-primary","mt-2","d-block","mx-auto",3,"disabled"],["class","text-center",4,"ngIf"],[3,"value"],[3,"removable","removed"],[1,"fa","fa-spinner","fa-spin"],[1,"text-center"],[1,"text-primary"]],template:function(s,n){if(1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3),e.NdJ("ngSubmit",function(){return n.sendImage()}),e.TgZ(4,"div")(5,"mat-form-field",4)(6,"mat-label"),e._uU(7,"Select Patient"),e.qZA(),e.TgZ(8,"mat-select",5),e.YNc(9,E,2,2,"mat-option",6),e.qZA(),e.YNc(10,F,4,0,"mat-error",7),e.qZA()(),e.TgZ(11,"div")(12,"ngx-dropzone",8),e.NdJ("change",function(i){return n.onSelect(i)}),e.TgZ(13,"ngx-dropzone-label"),e._uU(14,"Drop your image here"),e.qZA(),e.YNc(15,T,3,3,"ngx-dropzone-preview",9),e.qZA(),e.TgZ(16,"div",10)(17,"div",11),e._uU(18),e.qZA()()(),e.TgZ(19,"div")(20,"button",12),e.YNc(21,A,2,0,"span",7),e.YNc(22,I,3,0,"span",7),e.qZA(),e.YNc(23,U,4,1,"h2",13),e.qZA()()()()()),2&s){let c;e.xp6(3),e.Q6J("formGroup",n.sendImageForm),e.xp6(6),e.Q6J("ngForOf",n.patients),e.xp6(1),e.Q6J("ngIf",null==(c=n.sendImageForm.get("id"))||null==c.errors?null:c.errors.required),e.xp6(5),e.Q6J("ngForOf",n.files),e.xp6(2),e.Q6J("ngStyle",e.VKq(11,Z,n.percentage+"%")),e.uIk("aria-valuenow",n.percentage),e.xp6(1),e.hij(" ",n.percentage,"% "),e.xp6(2),e.Q6J("disabled",n.sendImageForm.invalid&&n.files!=e.DdM(13,b)),e.xp6(1),e.Q6J("ngIf",!n.loadingFlag),e.xp6(1),e.Q6J("ngIf",n.loadingFlag),e.xp6(1),e.Q6J("ngIf",n.prediction)}},dependencies:[l.ez,l.sg,l.O5,l.PC,_.bB,_._f,_.NP,_.dt,a.UX,a._Y,a.JJ,a.JL,a.sg,a.u,h.LD,d.KE,d.hX,d.TO,h.gD,D.ey,d.lN,f.c,a.u5],styles:[".response-container[_ngcontent-%COMP%]{border:1px solid #ccc;padding:20px;width:80%!important;margin-left:auto;margin-top:20px;box-shadow:0 0 10px #0000001a;border-radius:8px;background-color:#f9f9f9;font-family:Arial,sans-serif}.prompts[_ngcontent-%COMP%]{width:max-content;max-width:80%!important}.response-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:22px;margin-bottom:10px;color:#333}.response-container[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding-left:20px;margin-bottom:20px;list-style-type:disc}.response-container[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:10px;line-height:1.6}.response-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:15px;line-height:1.6;color:#555}.response-container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:700;color:#000}.left[_ngcontent-%COMP%]{position:absolute;top:90%;transform:translateY(-50%);right:0;display:flex;cursor:move;z-index:999}.left[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{cursor:pointer}.right[_ngcontent-%COMP%]{width:400px;position:absolute;top:50%;right:0;z-index:999;transform:translateY(-50%)}.right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardHeader[_ngcontent-%COMP%]{cursor:move;text-align:center}.right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardHeader[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{padding-block:10px;font-size:1.2rem;font-weight:500;text-transform:capitalize;margin:0}.right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardHeader[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{right:15px;font-size:30px;top:50%;transform:translateY(-50%);color:#555;cursor:pointer}.right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardBody[_ngcontent-%COMP%]{height:350px;max-width:400px;overflow:auto}.right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardFooter[_ngcontent-%COMP%]{padding:10px}.chat-ai[_ngcontent-%COMP%]{min-width:400px;z-index:9;top:50%;right:0;transform:translateY(-50%)}.chat-ai[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardHeader[_ngcontent-%COMP%]{text-align:center}.chat-ai[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardHeader[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{padding-block:10px;font-size:1.2rem;font-weight:500;text-transform:capitalize;margin:0}.chat-ai[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardHeader[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{right:15px;font-size:30px;top:50%;transform:translateY(-50%);color:#555;cursor:pointer}.chat-ai[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardBody[_ngcontent-%COMP%]{height:350px;max-width:400px;overflow:auto}.chat-ai[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   #card[_ngcontent-%COMP%]   #cardFooter[_ngcontent-%COMP%]{padding:10px}@media screen and (max-width: 768px){.right[_ngcontent-%COMP%]{width:360px!important}.chat-ai[_ngcontent-%COMP%]{min-width:380px!important;z-index:99}.chat-ai[_ngcontent-%COMP%]   #cardBody[_ngcontent-%COMP%]{max-width:380px!important}}"]})}return o})()}}]);